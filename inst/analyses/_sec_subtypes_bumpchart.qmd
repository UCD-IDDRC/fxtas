::: {#fig-pvd_chosen_subtypes_bumpplot custom-style="Caption"}

```{r}
#| fig-height: 6.69
#| fig-width: 8.27
#| label: figure3-bumpplot-pvd-chosen-subtypes
# max size: 170 mm x 210 mm = 6.69 x 8.27 inches 
stage_line_color <- "black"
# stage_line_color <- "#FFF"
stage_highlight_color <- "yellow"
# stage_highlight_color <- "#FFF"
scale_colors2 <- rcartocolor::carto_pal(name = "Safe")
group_1_color <- scale_colors2[1]
group_2_color <- scale_colors2[2]
group_3_color <- scale_colors2[3]
group_4_color <- scale_colors2[4]
group_5_color <- scale_colors2[5]
group_6_color <- scale_colors2[6]
group_7_color <- scale_colors2[7]
color_info <- tibble::tribble(
  ~event_name, ~line_color, ~highlight_color,
  "MRI: Cerebellar: Mild",  group_1_color, "#FFF",
  "MRI: Cerebral: Moderate/Severe", group_1_color, "#FFF",
  # "SCID: Anxiety Disorders: Threshold", group_1_color, "#FFF",
  "SCID: Mood Disorders: Threshold", group_1_color, "#FFF",
  "Corpus Callosum-Thickness: Thin", group_1_color, "#FFF",
  "Splenium WM Hyperintensity: Mild", group_1_color, "#FFF",
  "Genu WM Hyperintensity", group_1_color, "#FFF",
  "Parkinsonian Features", group_2_color, "#FFF",
  "Parkinson's", group_2_color, "#FFF",
  "FXTAS Stage: 1", stage_line_color, stage_highlight_color,
  "FXTAS Stage: 2", stage_line_color, stage_highlight_color,
  "FXTAS Stage: 3", stage_line_color, stage_highlight_color,
  "FXTAS Stage: 4", stage_line_color, stage_highlight_color,
  "FXTAS Stage: 5", stage_line_color, stage_highlight_color,
  "SWM Between Errors: > 26", group_3_color, "#FFF",
  "Postural Tremor", group_4_color, "#FFF",
  "Intermittent Tremor", group_5_color, "#FFF",
  "Intention Tremor", group_5_color, "#FFF",
  "Head Tremor", group_6_color, "#FFF",
  "Tandem Walk: Abnormal (<10 Steps)", group_7_color, "#FFF",
  "Ataxia Severity: 1", group_7_color, "#FFF",
  
)

bump <- figs_n_s_selected |> 
  pvd_subtype_lineplot(
    smooth = 15,
    y_lab = NULL,
    mult = .2,
    text_size = 7 / ggplot2::.pt,
    # text_size = 2.1,
    # text_size = 5,
    x_text_size = grid::unit(7, "pt"),
    align_stage = TRUE,
    events_to_highlight = color_info,
    use_group_colors = TRUE
  ) +
  theme(
    legend.margin = margin(t = 0)
  )

if (interactive()) {
  bump + ggview::canvas(
    width = 8.27,
    # height = 5.2,
    height = 6.69,
    units = "in",
    dpi = 600
  )
} else {
  print(bump)
}

ggplot2::ggsave(
  "inst/analyses/bump.png", 
  plot = bump, 
  width = 8.27, 
  height = 6.69, 
  units = "in", 
  dpi = 600
)

ggplot2::ggsave(
  "inst/analyses/Figure3.pdf", 
  plot = bump, 
  width = 8.27, height = 6.69, units = "in", 
  dpi = 600
)


```

**Differences in event sequences between latent subtypes,**
**aligned by FXTAS stage.**
Lines are used to show patterns of clinical interest.
`r biomarker_text_color_info` `r abbrevs_caption` `r subtype_pval_summaries`
:::
