# fxtas

The goal of `fxtas` is to apply the Ordinal SuStaIn algorithm (Young et
al. (2021)) to study disease progression in fragile X-associated
tremor/ataxia syndrome,  
as described in Morrison et al (not yet published), “Progression of
fragile X-associated tremor/ataxia syndrome revealed by subtype and
stage inference”.

## Installation

You can install the development version of fxtas from
[GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("UCD-IDDRC/fxtas")
```

## Running the analyses

The manuscript is implemented in the file `ordinal-sustain.qmd` in the
`analyses` subfolder, which incorporates several subfiles in this
repository. The `data-raw` folder contains numerous auxiliary scripts,
including:

- data preprocessing scripts, which be run in the following order (after
  extracting the necessary files from the GP, GP4, and Trax research
  databases):

  - `gp3.r`
  - `gp4.r`
  - `gp34.R`
  - `trax.R`

- [SLURM](https://slurm.schedmd.com/documentation.html) batch scripts
  and corresponding R scripts for pre-running the computation-heavy
  sections of the analysis on an appropriately-preconfigured distributed
  computing server.

If the corresponding output files have not been pre-generated,
`ordinal-sustain.qmd` should produce them.

# References

Young, Alexandra L, Jacob W Vogel, Leon M Aksman, Peter A Wijeratne,
Arman Eshaghi, Neil P Oxtoby, Steven CR Williams, Daniel C Alexander,
and Alzheimer’s Disease Neuroimaging Initiative. 2021. “Ordinal SuStaIn:
Subtype and Stage Inference for Clinical Scores, Visual Ratings, and
Other Ordinal Data.” *Frontiers in Artificial Intelligence* 4: 613261.
<https://doi.org/10.3389/frai.2021.613261>.

# Package index

## All functions

- [`add_default_labels()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/add_default_labels.md)
  : Add default variable labels

- [`add_labels()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/add_labels.md)
  : Add labels to biomarkers

- [`age_range_medians()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/age_range_medians.md)
  : replace decade codes with medians of those decades

- [`all_potential_biomarkers()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/all_potential_biomarkers.md)
  : Get a list of all potential biomarkers available in dataset

- [`autoplot(`*`<PF>`*`)`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/autoplot.PF.md)
  : Create positional variance diagram (PVD)

- [`autoplot(`*`<permutation_test>`*`)`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/autoplot.permutation_test.md)
  : Plot the distribution of a permuted test statistic

- [`build_abstract_plot()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/build_abstract_plot.md)
  : Build ggplot with abstract text for cowplot

- [`build_rds_path()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/build_rds_path.md)
  : Find path to RDS file with output

- [`build_score_vals()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/build_score_vals.md)
  : Construct the table indicating how many levels each biomarker has

- [`clean_gender()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/clean_gender.md)
  :

  Clean the variable `Gender`

- [`clean_mol_act_ratio()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/clean_mol_act_ratio.md)
  :

  Clean `mol_act_ratio` variable from gp4

- [`clean_numeric()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/clean_numeric.md)
  : Clean a Numeric Variable

- [`collapse_mri_levels()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/collapse_mri_levels.md)
  : Collapse MRI levels

- [`collapse_scid_levels()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/collapse_scid_levels.md)
  : Collapse SCID domain levels

- [`collect_permutation_test_stats()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/collect_permutation_test_stats.md)
  : Collect permutation test statistics

- [`combine_tremor()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/combine_tremor.md)
  : Combine exam and history tremor vars

- [`compact_pvd_est_data_prep()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/compact_pvd_est_data_prep.md)
  : plot_compact_pvd_est: data prep

- [`compact_pvd_facet_labels()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/compact_pvd_facet_labels.md)
  : Create facet labels

- [`compile_biomarker_group_list()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/compile_biomarker_group_list.md)
  : Compile a list of biomarker groups

- [`compile_biomarker_groups_table()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/compile_biomarker_groups_table.md)
  : Compile biomarker groups table

- [`compute_confus_matrix()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/compute_confus_matrix.md)
  :

  compute `confus_matrix` as in python version

- [`compute_prob_correct()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/compute_prob_correct.md)
  : Compute each biomarker's probability of being recorded at its
  baseline level

- [`compute_prob_correct2()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/compute_prob_correct2.md)
  : Title

- [`compute_prob_dist()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/compute_prob_dist.md)
  :

  Computes `p(true | obs)`? for each biomarker

- [`compute_prob_dist2()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/compute_prob_dist2.md)
  : Title

- [`compute_prob_scores()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/compute_prob_scores.md)
  : Compute probabilities of true biomarker levels

- [`compute_score_levels()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/compute_score_levels.md)
  : Title

- [`counts_and_pcts()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/counts_and_pcts.md)
  : Compute and paste counts and proportions

- [`create_scid_domains()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/create_scid_domains.md)
  : Create SCID domain variables

- [`cvic_sim_data`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/cvic_sim_data.md)
  : CVIC results from simulated data

- [`define_cases_and_controls()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/define_cases_and_controls.md)
  : Categorize \`CGG“

- [`.onLoad()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/dot-onLoad.md)
  :

  Actions taken when `fxtas` is loaded

- [`event_order_heatmap()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/event_order_heatmap.md)
  : Event order heatmap

- [`example_likelihoods`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/example_likelihoods.md)
  : example likelihoods matrix

- [`extract_cvic()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/extract_cvic.md)
  : Extract CVIC element from an object

- [`extract_figs_from_pickle()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/extract_figs_from_pickle.md)
  : Extact PVDs from pickle file

- [`extract_permuted_likelihoods()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/extract_permuted_likelihoods.md)
  : Extract permuted log-likelihoods from pickle files

- [`extract_results_from_pickle()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/extract_results_from_pickle.md)
  : Extract results from pickle file

- [`extract_results_from_pickles()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/extract_results_from_pickles.md)
  : Extract results from multiple pickle files

- [`flex_biomarkers_table()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/flex_biomarkers_table.md)
  :

  Print method for `biomarkers_table`

- [`format_likelihoods()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/format_likelihoods.md)
  : Title

- [`format_results_list()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/format_results_list.md)
  : Format results list extracted from pickle file

- [`get_biomarker_event_names()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/get_biomarker_event_names.md)
  : Extract biomarker event names

- [`get_biomarker_events_table()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/get_biomarker_events_table.md)
  : Construct biomarker events table

- [`get_levels()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/get_levels.md)
  : Extract levels from a set of variable names

- [`get_observed_permutation_test_stat()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/get_observed_permutation_test_stat.md)
  : Compute permutation test statistic

- [`get_visit1()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/get_visit1.md)
  : Get each participant's first visit in dataset

- [`graph_CGG_repeats()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/graph_CGG_repeats.md)
  : Barplot of CGG repeats

- [`graph_likelihoods_v2()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/graph_likelihoods_v2.md)
  : Title

- [`graph_stage_by_age()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/graph_stage_by_age.md)
  : graph stage by age

- [`graphical_abstract()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/graphical_abstract.md)
  : Graphical Abstract

- [`group_colors()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/group_colors.md)
  : Extract group colors

- [`install_pySuStaIn()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/install_pySuStaIn.md)
  :

  Install the `pySuStaIn` python package from github

- [`labels(`*`<list>`*`)`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/labels.list.md)
  : Extract variable labels from list

- [`make_biomarker_events_table()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/make_biomarker_events_table.md)
  : Construct biomarker events table

- [`make_biomarkers_table()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/make_biomarkers_table.md)
  : Make biomarkers table

- [`make_demographics_table()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/make_demographics_table.md)
  : Make demographics table

- [`missing_pattern_by_ID()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/missing_pattern_by_ID.md)
  : Title

- [`missingness_reasons.factor()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/missingness_reasons.factor.md)
  : Compute missingness reasons for a vector of factor variables

- [`missingness_reasons.numeric()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/missingness_reasons.numeric.md)
  : Title

- [`model_dists()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/model_dists.md)
  : Title

- [`pander(`*`<prob_correct>`*`)`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/pander.prob_correct.md)
  :

  Print `prob_correct` objects as Pandoc markdown tables

- [`permutation_test()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/permutation_test.md)
  : Compute permutation test p-value

- [`plot_CVIC()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/plot_CVIC.md)
  : Plot a CVIC curve

- [`plot_compact_pvd()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/plot_compact_pvd.md)
  : Plot compact PVD tmp function using list of extract_figs_from_pickle

- [`plot_compact_pvd_est()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/plot_compact_pvd_est.md)
  : Plot compact PVD with point estimates only

- [`plot_compact_pvd_est2()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/plot_compact_pvd_est2.md)
  : Plot SuStaIn Sequential Estimate

- [`plot_cv_loglik()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/plot_cv_loglik.md)
  : Plot cross-validated per-fold log-likelihood distributions

- [`plot_heatmap()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/plot_heatmap.md)
  : Title

- [`plot_permutation_results()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/plot_permutation_results.md)
  : Plot permutation test results

- [`plot_positional_var()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/plot_positional_var.md)
  : Plot positional variance diagram

- [`print(`*`<permutation_test>`*`)`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/print.permutation_test.md)
  : print method for "permutation_test" objects

- [`print_PVDs()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/print_PVDs.md)
  : Print a list of PVDs

- [`pvd_lineplot()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/pvd_lineplot.md)
  : Plot change in Stage ranking

- [`pvd_subtype_lineplot()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/pvd_subtype_lineplot.md)
  : Display Sequential Order of Events by Subtype

- [`remove_missingness_reason_vars()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/remove_missingness_reason_vars.md)
  : Remove variable

- [`replace_missing_codes()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/replace_missing_codes.md)
  : Replace missing codes in a vector of factor variables

- [`replace_missing_codes_with_NAs()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/replace_missing_codes_with_NAs.md)
  : Replace missing codes with NAs

- [`report_sex_differences()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/report_sex_differences.md)
  : Report sex differences

- [`run_OSA()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/run_OSA.md)
  : Run the Ordinal SuStaIn Algorithm (OSA)

- [`run_OSA_permuted()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/run_OSA_permuted.md)
  : Randomly permute some some variables and run the OSA model on the
  permuted data

- [`run_and_save_OSA()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/run_and_save_OSA.md)
  : Run the Ordinal SuStaIn algorithm (OSA) or load results from
  presaved .rds file if available

- [`run_app()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/run_app.md)
  : Run the Shiny Application

- [`save_run_info()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/save_run_info.md)
  : Save run info to file

- [`scid_vars_for_table1()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/scid_vars_for_table1.md)
  : List SCID variables to display in data summary tables

- [`search_articles()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/search_articles.md)
  : Search PubMed for FXTAS-related articles

- [`shared_flextable_settings()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/shared_flextable_settings.md)
  : Apply flextable settings to match Brain journal requirements

- [`sim_data`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/sim_data.md)
  : Simulated data

- [`sim_subtype_and_stage_table`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/sim_subtype_and_stage_table.md)
  : Simulated subtype-and-stage table

- [`stage_barplot()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/stage_barplot.md)
  : Plot estimated stage counts

- [`stage_barplot(`*`<SuStaIn_model>`*`)`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/stage_barplot.SuStaIn_model.md)
  : Plot estimated stage counts

- [`stage_barplot(`*`<default>`*`)`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/stage_barplot.default.md)
  : Plot estimated stage counts

- [`stage_barplot(`*`<list>`*`)`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/stage_barplot.list.md)
  : Plot estimated stage counts

- [`stratified_formula()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/stratified_formula.md)
  :

  Build a formula for
  [`table1::table1()`](https://rdrr.io/pkg/table1/man/table1.html)

- [`summary(`*`<permutation_test>`*`)`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/summary.permutation_test.md)
  :

  Summary method for `permutation_test` objects

- [`table1a()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/table1a.md)
  :

  [`table1::table1()`](https://rdrr.io/pkg/table1/man/table1.html) with
  customized settings

- [`table_subtype_by_demographics()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/table_subtype_by_demographics.md)
  : Create table of demographics statistics by most-likely latent
  subtype

- [`test_data`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/test_data.md)
  : Test Data

- [`test_data_v1`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/test_data_v1.md)
  : Test Data - Visit 1

- [`test_subtype_and_stage_table`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/test_subtype_and_stage_table.md)
  : Simulated subtype-and-stage table

- [`write_permuted_test_stats()`](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/reference/write_permuted_test_stats.md)
  : Write permuted test stats as RDS

# Articles

### All vignettes

- [demo
  table_subtype_by_demographics()](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/articles/demo-table-subtype-by-demographics.md):
- [test-quarto-article](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/articles/test-quarto-article.md):
- [test-quarto-vignette](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/articles/test-quarto-vignette.md):
- [test-rmarkdown-article](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/articles/test-rmarkdown-article.md):
- [test-vignette](https:/UCD-IDDRC.github.io/fxtas/preview/pr149/articles/test-rmarkdown-vignette.md):
