```{r}
#| label: extract-figs-from-pickle-n-s-selected
figs =
  extract_figs_from_pickle(
    size.y = size.y,
    n_s = n_s_selected,
    dataset_name = dataset_name,
    output_folder = output_folder)

figs <- figs[subtype_order] |>   
  rlang::set_names(paste("Subtype", 1:n_s_selected))
```

:::: landscape

::: {#suppfig-pvd_chosen_subtypes_bumpplot}

```{r}

color_info <- tibble::tribble(
  ~event_name, ~line_color, ~highlight_color,
  "MRI: Cerebellar: Mild",  "orange", "#FFF",
  "MRI: Cerebral: Moderate/Severe", "orange", "#FFF",
  # "SCID: Anxiety Disorders: Threshold", "orange", "#FFF",
  "SCID: Mood Disorders: Threshold", "orange", "#FFF",
  "Corpus Callosum-Thickness: Thin", "orange", "#FFF",
  "Splenium WM Hyperintensity: Mild", "orange", "#FFF",
  "Genu WM Hyperintensity", "orange", "#FFF",
  "Parkinsonian Features", "green", "#FFF",
  "Parkinsons", "green", "#FFF",
  "FXTAS Stage: 1", "black", "yellow",
  "FXTAS Stage: 2", "black", "yellow",
  "FXTAS Stage: 3", "black", "yellow",
  "FXTAS Stage: 4", "black", "yellow",
  "FXTAS Stage: 5", "black", "yellow",
  "SWM Between Errors: > 26", "purple", "#FFF",
  "Postural Tremor", "red", "#FFF",
  "Head Tremor", "cyan3", "#FFF"
)

figs |> pvd_subtype_lineplot(
  smooth = 30,
  events_to_highlight = color_info)
```


**Differences in event sequences between pairs of latent subtypes.**
`r compact_fig_cap2`

:::

::::

::: {#suppfig-pvd_chosen_subtypes_linegraphs}

```{r}
#| label: fig-pvd_chosen_subtypes_linegraphs-1
#| fig-height: !expr pvd_line_height
#| fig-width: !expr pvd_line_width
#| fig-cap:
#|    - "**Subtype 1 compared to Subtype 2**"

figs[c(1, 2)] |> pvd_lineplot(text_size = lineplot_text_size)

```


```{r}
#| label: fig-pvd_chosen_subtypes_linegraphs-2
#| fig-height: !expr pvd_line_height
#| fig-width: !expr pvd_line_width
#| fig-cap:
#|    - "**Subtype 1 compared to Subtype 3**"

figs[c(1, 3)] |> pvd_lineplot(text_size = lineplot_text_size)

```


```{r}
#| label: fig-pvd_chosen_subtypes_linegraphs-3
#| fig-height: !expr pvd_line_height
#| fig-width: !expr pvd_line_width
#| fig-cap:
#|    - "**Subtype 1 compared to Subtype 4**"

figs[c(1, 4)] |> pvd_lineplot(text_size = lineplot_text_size)

```

```{r}
#| label: fig-pvd_chosen_subtypes_linegraphs-4
#| fig-height: !expr pvd_line_height
#| fig-width: !expr pvd_line_width
#| fig-cap:
#|    - "**Subtype 2 compared to Subtype 3**"

figs[c(2, 3)] |> pvd_lineplot(text_size = lineplot_text_size)

```


```{r}
#| label: fig-pvd_chosen_subtypes_linegraphs-5
#| fig-height: !expr pvd_line_height
#| fig-width: !expr pvd_line_width
#| fig-cap:
#|    - "**Subtype 2 compared to Subtype 4**"

figs[c(2, 4)] |> pvd_lineplot(text_size = lineplot_text_size)

```

```{r}
#| label: fig-pvd_chosen_subtypes_linegraphs-6
#| fig-height: !expr pvd_line_height
#| fig-width: !expr pvd_line_width
#| fig-cap:
#|    - "**Subtype 3 compared to Subtype 4**"

figs[c(3, 4)] |> pvd_lineplot(text_size = lineplot_text_size)

```

**Differences in event sequences between pairs of latent subtypes.**
`r compact_fig_cap2`

:::
