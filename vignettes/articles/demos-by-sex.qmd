## First-Visit Characteristics by Gender for CGG > 55

```{r}
#| include: false
knitr::opts_chunk$set(
  collapse = TRUE,
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  comment = "#>",
  fig.width = 7.5,
  fig.height = 4
)

# update 'asis' chunk to allow inline code
knitr::knit_engines$set(asis = function(options) {
  if (options$echo && options$eval) knitr::knit_child(text = options$code)
})
```

```{r}
#| message: false
#| label: setup-demos-by-sex
library(fxtas)
devtools::load_all()
library(pander)
library(table1)
library(dplyr)
library(magrittr)
column_var = c("Gender", "FX3*")
visit1_cgg_55_199 = 
  trax_gp34_v1 |> 
  filter(CGG |> between(55, 199))



```

### Demographics

```{r}
#| label: "tbl-demographics-by-sex"
#| tbl-cap: "Demographics"
vars = c(
  "Study",
  "Age at visit",
  "# visits",
  # column_var,
  "Primary Ethnicity",
  "Primary Race"
  
)

table1a(
  
  stratified_formula(vars, column_var),
  # render.continuous = c(.="N", .="Mean (SD)", .="Median [Min,  Max]"),
  data = visit1_cgg_55_199)
```

### ApoE

```{r}
#| tbl-cap: "ApoE"
#| label: "tbl-apoe-by-sex"
# vars = grep("^ApoE", names(gp34), value = TRUE)
vars = "ApoE"
table1a(
  stratified_formula(vars, column_var),
  # render.missing=c("Empty in RedCap"="FREQ (PCT%)"),
  data = visit1_cgg_55_199)
```

### Drug use

```{r}
#| label: tbl-lifestyle-by-sex
#| tbl-cap: "Drug use characteristics by sex"
vars = c("Drug use",
         "Marijuana use",
         "Alcohol use/abuse",
         "# of drinks per day now",
         "# of drinks per day now: missingness reasons")

table1a(
  
  stratified_formula(vars, column_var),
  # render.continuous = c(.="N", .="Mean (SD)", .="Median [Min,  Max]"),
  footnote = paste0(
    '"Alcohol Abuse" in GP3 (`mds_psy_alco`) ',
    'and "Alcohol Use" in GP4 (`new_mds_psy_alco`) ',
    'were combined as "Alcohol use/abuse".'),
  data = visit1_cgg_55_199)

```

### Cancer

```{r}
vars = c(
  "Thyroid Cancer",
  "Skin Cancer",
  "Melanoma",
  "Prostate Cancer",
  "Other Cancer",
  "Any Cancer"
)

table1a(
  
  stratified_formula(vars, column_var),
  data = visit1_cgg_55_199)
```

::: hidden
### Surgery

```{r}

vars = 
  c(
    "Surgery",
    "Anesthesia (medic_surg_anes)", 
    "Anesthesia (new_mds_med_anes1)"
    # "Other Cancer (detailed)", # don't include in table
    # "Surgery",
    # "Surgery type",
    # "Surgery: Type/Age",
    # "Surgery 2: Type/Age",
    # "Surgery 3: Type/Age",
    # "Surgery 4: Type/Age",
    # "Surgery 5: Type/Age",
  )
# grep(pattern = "surgery", ignore.case = TRUE, x = names(gp34), value = TRUE)

library(table1)
table1a(
  
  stratified_formula(vars, column_var),
  data = visit1_cgg_55_199)
```
:::

### Tremors

```{r}
vars = c(
  
  "Intention tremor",
  "Resting tremor",
  "Postural tremor",
  "Intermittent tremor"
  # "Any tremor (excluding Head Tremor)"
  # "Tremor: Age of onset"
  # "Tremor: Age of onset: missingness reasons"
)
table1a(
  
  stratified_formula(vars, column_var),
  render.continuous = c(
    .="N", 
    .="Mean (SD)", 
    .="Median [Min, Max]"),
  data = visit1_cgg_55_199)

```

<br>

### Head tremors

```{r}
#| tbl-cap: Head tremors
#| label: tbl-head-tremors-by-sex
vars = c(
  "Head tremor"
  # "Head Tremor: Age of onset"
  
)

footnote_HT <- paste(
  "Head tremor was not collected in GP3 or Trax Phase 1.",
  "Summaries provided are for GP4 + Trax Phase 2 only."
)
table1a(
  
  stratified_formula(vars, column_var),
  # render.continuous = c(.="N", .="Mean (SD)", .="Median [Min,  Max]"),
  data = visit1_cgg_55_199 |> 
    filter(!(Study %in% c("Trax Phase 1", "GP3"))),
  footnote = footnote_HT)

```

### Ataxia

```{r}

vars = c(
  "Ataxia",
  "Ataxia: severity",
  "Ataxia: severity*"
  # "Ataxia: Age of onset",
  # "Ataxia: Age of onset: missingness reasons"
)

table1a(
  
  stratified_formula(vars, column_var),
  # render.continuous = c(.="N", .="Mean (SD)", .="Median [Min,  Max]"),
  data = visit1_cgg_55_199)

```


<br>

### Parkinsons

```{r}

vars = grep("Parkinson", value = TRUE, names(gp34))

table1a(
  
  stratified_formula(vars, column_var),
  data = visit1_cgg_55_199)

```

### FXTAS Stage

```{r}

vars = c(
  "FXTAS Stage (0-5)*",
  "FXTAS Stage (0-5)*: missingness reasons")

table1a(
  
  stratified_formula(vars, column_var),
  # render.continuous = c(.="N", .="Mean (SD)", .="Median [Min,  Max]"),
  footnote = "For categorical analysis, we merged 2.5 into 2, 3.5 into 4, and 4.5 into 5.",
  data = visit1_cgg_55_199)

# gp34 |> 
#   filter(`FXTAS Stage (0-5)` %in% c(NA, "No Response (999)", "Missing (empty in RedCap)")) |> 
#   select(`FXS ID`, `Event Name`, `Visit Date`) |> 
#   arrange() |> 
#   readr::write_csv("inst/extdata/missing_FXTAS_stage.csv")

```

### BDS2

```{r}

vars = grep("BDS-2 Total Score", value = TRUE, names(gp34), fixed = TRUE)

table1a(
  
  stratified_formula(vars, column_var),
  # render.continuous = c(.="N", .="Mean (SD)", .="Median [Min,  Max]"),
  footnote = footnote1,
  data = visit1_cgg_55_199)

```

### MMSE



```{r}

vars = grep(
  "MMSE Total Score", 
  value = TRUE, 
  names(gp34), 
  fixed = TRUE)

table1a(
  
  stratified_formula(vars, column_var),
  footnote = footnote1,
  # render.continuous = c(.="N", .="Mean (SD)", .="Median [Min,  Max]"),
  data = visit1_cgg_55_199)

```

### SCID

```{r}

scid_vars_for_table1()

table1a(
  stratified_formula(vars, column_var),
  # render.continuous = c(.="N", .="Mean (SD)", .="Median [Min,  Max]"),
  data = visit1_cgg_55_199)

```

### SCL90

For analysis with the Ordinal SuStaIn method, we dichotomized each SCL90 measure as clinically elevated (60+) vs not.

```{r}

vars = grep(value = TRUE, fixed = TRUE, names(gp34), pattern = "SCL90") |> sort()

table1a(
  
  stratified_formula(vars, column_var),
  # render.continuous = c(.="N", .="Mean (SD)", .="Median [Min,  Max]"),
  data = visit1_cgg_55_199)

# visit1_cgg_55_199 |> ggplot(aes(x = `SCL90: Anxiety`, group = `FX*`)) + geom_histogram() + facet_wrap(~`FX*`, ncol = 1)
```

### MRI

```{r}

vars = c(
  "Cerebral Atrophy",
  "Cerebellar Atrophy",
  "Cerebral WM Hyperintensity",
  "Cerebellar WM Hyperintensity",
  "MCP-WM Hyperintensity",
  "Pons-WM Hyperintensity",
  "Sub-Insular WM Hyperintensity",
  "Periventricular WM Hyperintensity",
  "Splenium (CC)-WM Hyperintensity",
  "Genu (CC)-WM Hyperintensity",
  "Corpus Callosum-Thickness"
)

table1a(
  
  stratified_formula(vars, column_var),
  data = visit1_cgg_55_199)

```

### WAIS

```{r}

vars = c(
  # "Verbal: IQ Score",
  "Verbal Comprehension: Composite Score (VCI)",
  
  "Perceptual Reasoning: Composite Score (PRI)",
  "Working Memory: Composite Score (WMI)", 
  "Processing Speed: Composite Score (PSI)",
  
  # "Full Scale: IQ Score",
  "Full Scale: Composite Score (FSIQ)"
) |> sapply(F = function(x) grep(value =  TRUE, fixed = TRUE, pattern = x, x = names(visit1_cgg_55_199))) |> as.vector()

table1a(
  
  stratified_formula(vars, column_var),
  # render.continuous = c(.="N", .="Mean (SD)", .="Median [Min, Max]"),
  data = visit1_cgg_55_199)

```

### CANTAB

For now, we used cutoffs taken from [@talebi2020cambridge].

```{r}

# table1a(
#   
#   stratified_formula("Drugs used", column_var),
#   data = visit1_cgg_55_199)


cantab_vars = c(
  "SWM Between errors",
  "SWM Between errors*",
  "SST Median correct RT on GO trials",
  "RVP A signal detection",
  "RVP A signal detection*",
  "OTS Problems solved on first choice",
  "PAL Total errors (adjusted)",
  "PAL Total errors (adjusted)*",
  "RTI Five-choice movement time",
  "RTI Five-choice movement time*") 
# |> 
#   sapply(F = function(x) grep(value =  TRUE, fixed = TRUE, pattern = x, x = names(visit1_cgg_55_199))) |> 
# as.vector()

table1a(
  NA.label = "Missing (empty in RedCap)",
  stratified_formula(cantab_vars, column_var),
  # render.continuous = c(.="N", .="Mean (SD)", .="Median [Min,  Max]"),
  data = visit1_cgg_55_199)
```

### Thyroid and other autoimmune diseases

```{r}

vars = c(
  "Hypothyroid",
  "Hyperthyroid",
  "Thyroid problems",
  "Lupus",
  "Rheumatoid arthritis",
  "Multiple Sclerosis: Workup",
  "ANA positive",
  "Sjogrens Syndrome",
  "Raynauds Syndrome",
  "Pulmonary Fibrosis",
  "Any Autoimmune"
)

table1a(
  
  stratified_formula(vars, column_var),
  data = visit1_cgg_55_199)
```

### Kinesia

We categorized each kinesia variable as "0-1", "1-2", "2-3", and "3-4".

```{r}
kinesia_vars = c(
  "Kinesia Left Rest Tremor",
  "Kinesia Left Postural Tremor",
  "Kinesia Left Kinetic Tremor",
  "Kinesia Right Rest Tremor",
  "Kinesia Right Postural Tremor",
  "Kinesia Right Kinetic Tremor"
)
kinesia_vars = 
  c(kinesia_vars,
    paste0(kinesia_vars, "*")) |> 
  sort()

table1a(
  
  stratified_formula(kinesia_vars, column_var),
  data = visit1_cgg_55_199)

```


### Purdue pegboard for reaction time

```{r}
purdue_vars = c(
  "Purdue pegboard 1st Trial Total, R+L+B",
  "Purdue pegboard 1st Trial Total, R+L+B: missingness reasons")

table1a(
  
  stratified_formula(purdue_vars, column_var),
  # render.continuous = c(.="N", .="Mean (SD)", .="Median [Min,  Max]"),
  data = visit1_cgg_55_199)
```


### MOCA total score

```{r}

moca_vars = c(
  "MOCA Total score",
  "MOCA Total score: missingness reasons"
)
table1a(
  
  stratified_formula(moca_vars, column_var),
  # render.continuous = c(.="N", .="Mean (SD)", .="Median [Min,  Max]"),
  data = visit1_cgg_55_199)

```

