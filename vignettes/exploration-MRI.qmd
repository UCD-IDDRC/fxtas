---
title: "Questions about FXTAS Sequence Data"
format:
  html:
    toc: true
    toc-depth: 4
    toc-float: true
    number-sections: true
    embed-resources: true
  docx:
    number-sections: true
---

```{r, include = FALSE}

knitr::opts_chunk$set(
  collapse = TRUE,
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  comment = "#>",
  fig.width = 7.5,
  fig.height = 4
)

# update 'asis' chunk to allow inline code
knitr::knit_engines$set(asis = function(options) {
  if (options$echo && options$eval) knitr::knit_child(text = options$code)
})
```

```{r setup}
#| message: false
library(fxtas)
devtools::load_all()
library(pander)
library(table1)
library(dplyr)
library(magrittr)
NA.label1 = "Missing"
column_var = "Recruited in study phase"
column_var = "FX**"
# load_all()

phase <- ifelse(column_var == "Recruited in study phase", TRUE, FALSE)
cgg <- ifelse(column_var == "FX**", TRUE, FALSE)
```

# General data processing notes

## Missing codes

The missing codes 777, 888, and 999 were converted to `NA` for all variables, unless noted otherwise below.

# Data from first visits

```{asis, echo=phase}
Here, we review the data from the first visits by each participant, stratified by 
the first study phase in which the participant enrolled (GP3 vs GP4).
```

```{asis, echo=cgg}
Here, we review the data from the first visits by each participant, stratified by CGG (`r paste0("<55 or", " \u2265", "55")`).
```



## MRI

The vast majority of the `MRI` data are missing. Due to this the data are summarized by `CGG` and `Study`. The `MRI` data are completely missing in GP3 and largely missing for those in GP4 who are not `CGG` $\ge55$.

```{r}

vars = c(
  "Cerebral Atrophy",
  "Cerebellar Atrophy",
  "Cerebral WM Hyperintensity",
  "Cerebellar WM Hyperintensity",
  "MCP-WM Hyperintensity",
  "Pons-WM Hyperintensity",
  "Sub-Insular WM Hyperintensity",
  "Periventricular WM Hyperintensity",
  "Splenium (CC)-WM Hyperintensity",
  "Genu (CC)-WM Hyperintensity",
  "Corpus Callosum-Thickness"
)

table1(
  NA.label = NA.label1,
  as.formula(
    paste(
      " ~ ",
      paste(formulaic::add.backtick(vars), collapse = " + "), 
      "|",
      paste0("Study", " * ", formulaic::add.backtick(column_var)), 
      sep = ""
    )
  ),
  data = visit1)

```

<br>

The list of patients in GP4 with completely missing `MRI` data are shown below:

```{r}
mri_gp4_na <- visit1 |>
  filter(
    Study == "GP4" & 
      if_all(
        vars,
        is.na
      )
  ) |>
  dplyr::select(
    `FXS ID`, `Event Name`, all_of(vars)
  )
```

```{r}
display_DT(mri_gp4_na, "GP4_MRI", group = FALSE)
```
